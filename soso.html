<!DOCTYPE html>
<meta charset="utf-8">
<body>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://d3js.org/d3.v2.min.js"></script>

<div id="inspiration"></div>
<div id="textwriter" style="font-family:Brain Flower; font-size: 48px"></div>
<!-- <script type="text/javascript" src="/js/inspiration.js"></script>
 -->

<script>
$.fn.teletype = function(opts){
    var $this = this,
        defaults = {
            animDelay: 50
        },
        settings = $.extend(defaults, opts);
    
    $.each(settings.text, function(i, letter){
        setTimeout(function(){
            $this.html($this.html() + (letter != '\n' ? letter : '<br />'));
        }, settings.animDelay * i);
    });
};

$(function(){
    $('#textwriter').teletype({
        animDelay: 300,
        text: 'HOW YA DOIN, IDEO?'
    });
});
//and then each office name pipes up as its circle folds in to the line
//it could be a circle not a line?
//begin with a transition and delay and let each person out one by one

var width = 4000,
		height = 1300;
var margin = 100;

var groupColors = ["red","teal","yellow"]
var how = ["out of it","into it","soso"]

d3.json("ideo.json", function(data, error) {
	// console.log(data)
	console.log(data.length)

var maxResponse = d3.max(data, function(d,i) { 
		return i;
});

var widthMap = d3.scale.linear()
	.domain([0, maxResponse]) //max feasibility
	.range([margin, width+width/4]);

var bigMap = d3.scale.linear()
	.domain([0, maxResponse]) //max feasibility
	.range([margin, width]);

function zoom() {
	circ.attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")");
}

var svg = d3.select("body").append("svg")
		.attr({
					"width": "100%",
					"height": "100%"
			})
			.attr("viewBox", "0 0 " + width + " " + height )
			.attr("preserveAspectRatio", "xMinYMin")
			.attr("pointer-events", "all")
			.append("g")
			.call(d3.behavior.zoom().scaleExtent([1, 8]).on("zoom", zoom))
			.append("g");


$.fn.unteletype = function(opts){
    var $this = this,
        defaults = {
            animDelay: 50
        },
        settings = $.extend(defaults, opts);
    
    $.each(settings.text.split(''), function(i, letter){
        setTimeout(function(){
            $this.html($this.html() - letter);
        }, settings.animDelay * i);
    });
};
// var circ = svg.append("g");
// 		circ.selectAll("circle")
// 			 .data(data)
// 			 .enter()
// 			 .append("circle")
// 			 .attr("cy", -10)
// 			 .attr("cx", -10)
// 			 .attr("r", 0);

// setTimeout(function(){
// 		circ.selectAll("g")
// 			 .data(data)
// 			 .enter()
// 			 .append("circle")
// 			 .transition()
// 			 .duration(4000)
// 			 .delay(function(d,i) { 
// 			 		return i * 200; 
// 			 	})
// .ease([.1,1])			 
// 			 .attr("cy", function(d,i) {
// 				if (d.engaged==="into it"){
// 				return height/3;
// 				}
// 				if (d.engaged==="soso"){
// 				return height/2;
// 				} 
// 				if (d.engaged==="out of it"){
// 				return height*2/3;
// 				} 
// 			 })
// 			 .attr("cx", function(d,i) {
// 				return widthMap(i);
// 							 // return projection([d.lon, d.lat])[1];
// 			 })
// 			 .attr("r", 50)
// 			 .attr("fill", function(d,i){
//     			for (var s = 0; s<how.length; s++){
//     					if (d.engaged===how[s]){
//         				return groupColors[s];
//     					}
//     			}
// 			 })
// 			 .attr("stroke-width","0")
// 			 .attr("stroke","white")
// 			 .attr("opacity", ".1")

// 			 .transition()
// 			 .delay(20000)
// 			 .duration(4000)
// 			 // .delay(function(d,i) { 
// 			 // 		return i * 800; 
// 			 // 	})
// 			 .ease([.1,1])			 
// 			 .attr("cy",height)
// 			 .attr("stroke-width","10")
// 			 .attr("stroke","white")
// 			 .attr("r",600)
// 			 // .attr("opacity", ".03");
// }, 1000);



makeCircs()
var circ = svg.selectAll("ellipse")

function makeCircs(){
var circ = svg.append("g");
		circ.selectAll("ellipse")
			 .data(data)
			 .enter()
			 .append("ellipse")
			 .attr("cy", -10)
			 .attr("cx", -10)
			 .attr("rx", 5)
			 .attr("ry", 5)
			 .attr("opacity", ".2") //or .1?
			 .attr("fill", function(d,i){
    			for (var s = 0; s<how.length; s++){
    					if (d.engaged===how[s]){
        				return groupColors[s];
    					}
    			}
			 })
			 // .attr("stroke-width","0")
			 // .attr("stroke", "white")
}
//first transition for overall view
setTimeout(function(){
		circ
			 .transition()
			 .duration(1000)
			 .delay(function(d,i) { 
			 		return i * 200; 
			 	})
			 .ease([.1,1])	

			 .attr("rx", height/8)
			 .attr("ry", 0)
			 .attr("cx", function(d,i){
			 	return bigMap(i)
			 })
			 .attr("cy", 0)
//keep this?
			 .transition()
			 .duration(8000)
			 .delay(function(d,i) { 
			 		return i * 200; 
			 	})
			 .ease([.1,1])	

			 .attr("rx", 100)
			 .attr("ry", height)
			 .attr("cy", height/2)

}, 4000);

//second transition for INTO IT
setTimeout(function(){
$(function(){
    $('#textwriter').teletype({
        animDelay: 50,
        text: '\n --into it'
    });
});
		circ
			 .transition()
			 .duration(1000)
			 .delay(function(d,i) { 
			 		return i * 200; 
			 	})
			 .ease([.1,1])

			 // .attr("stroke-width","1")
			 // .attr("stroke", "gray")
			 .attr("rx", function(d,i){
				if (d.engaged==="into it"){
				return height/3;
				}
				else {
					return 10;
				}
				})
			 .attr("cy", function(d,i) {
				if (d.engaged==="into it"){
				return height/3;
				}
				else {
					return height/2;
				}
			 })
			 .attr("ry", function(d,i){
				if (d.engaged==="into it"){
				return height/3;
				}
				else {
					return height;
				}
				})
}, 29000);

//transition for SOSO
setTimeout(function(){	
$(function(){
    $('#textwriter').teletype({
        animDelay: 50,
        text: '--so so--'
    });
});
		circ
			 .transition()
			 .duration(1000)
			 .delay(function(d,i) { 
			 		return i * 200; 
			 	})
			 .ease([.1,1])

			 .attr("rx", function(d,i){
				if (d.engaged==="into it"){
				return height/3;
				}
				if (d.engaged==="soso"){
				return height/4;
				}
				else {
					return 10;
				}
				})
			 .attr("ry", function(d,i){
				if (d.engaged==="into it"){
				return height/3;
				}
				if (d.engaged==="soso"){
				return height/4;
				}
				else {
				return height;
				}
				})
			 .attr("cy", function(d,i) {
				if (d.engaged==="into it"){
				return height/3;
				}
				if (d.engaged==="soso"){
				return height*2/3;
				}
				else {
				return height/2;
				}
			 })
}, 52000);

//transition for OUT OF IT
setTimeout(function(){	
$(function(){
    $('#textwriter').teletype({
        animDelay: 50,
        text: 'out of it--'
    });
});
		circ
			 .transition()
			 .duration(1000)
			 .delay(function(d,i) { 
			 		return i * 200; 
			 	})
			 .ease([.1,1])

			 .attr("rx", function(d,i){
				if (d.engaged==="into it"){
				return height/3;
				}
				if (d.engaged==="soso"){
				return height/4;
				}
				else {
					return height/5;
				}
				})
			 .attr("ry", function(d,i){
				if (d.engaged==="into it"){
				return height/3;
				}
				if (d.engaged==="soso"){
				return height/4;
				}
				else {
				return height/5;
				}
				})
			 .attr("cy", function(d,i) {
				if (d.engaged==="into it"){
				return height/3;
				}
				if (d.engaged==="soso"){
				return height*2/3;
				}
				else {
				return height*4/5;
				}
			 })
},75000);

//OVERALL VIEW
setTimeout(function(){
$(function(){
    $('#textwriter').unteletype({
        animDelay: 50,
        // text: 'out of it--'
    });
    $('#textwriter').teletype({
        animDelay: 50,
        text: 'We are Doin'
    });
});
		circ
			 // .transition()
			 // .duration(1000)
			 // .delay(function(d,i) { 
			 // 		return i * 200; 
			 // 	})
			 // .ease([.1,1])	

			 // .attr("rx", height/8)
			 // .attr("ry", 0)
			 // .attr("cx", function(d,i){
			 // 	return bigMap(i)
			 // })
			 // .attr("cy", 0)
//keep this?
			 .transition()
			 .duration(8000)
			 .delay(function(d,i) { 
			 		return i * 200; 
			 	})
			 .ease([.1,1])	

			 .attr("rx", 100)
			 .attr("ry", height)
			 .attr("cy", height/2)

}, 97000);















































//THIS WORKS WELL
// var circ = svg.append("g");
// 		circ.selectAll("ellipse")
// 			 .data(data)
// 			 .enter()
// 			 .append("ellipse")
// 			 .attr("cy", -10)
// 			 .attr("cx", -10)
// 			 .attr("rx", 0)
// 			 .attr("ry", 0);

// setTimeout(function(){
// 		circ.selectAll("g")
// 			 .data(data)
// 			 .enter()
// 			 .append("ellipse")
// 			 .transition()
// 			 .duration(1000)
// 			 .delay(function(d,i) { 
// 			 		return i * 200; 
// 			 	})
// .ease([.1,1])			 
// 			 .attr("cy", function(d,i) {
// 				if (d.engaged==="into it"){
// 				return height/3;
// 				}
// 				if (d.engaged==="soso"){
// 				return height/2;
// 				} 
// 				if (d.engaged==="out of it"){
// 				return height*2/3;
// 				} 
// 			 })
// 			 .attr("cx", function(d,i) {
// 				return widthMap(i);
// 							 // return projection([d.lon, d.lat])[1];
// 			 })
// 			 .attr("rx", 50)
// 			 .attr("ry", 50)
// 			 .attr("fill", function(d,i){
//     			for (var s = 0; s<how.length; s++){
//     					if (d.engaged===how[s]){
//         				return groupColors[s];
//     					}
//     			}
// 			 })
// 			 .attr("stroke-width","0")
// 			 .attr("stroke","white")
// 			 .attr("opacity", ".1")

// 			 .transition()
// 			 //NOT QUITE ENOUGH DELAY
// 			 .delay(25000)
// 			 .duration(4000)
// 			 .ease([.1,1])			 
// 			 .attr("cy",height)
// 			 // .attr("stroke-width","10")
// 			 // .attr("stroke","white")
// 			 .attr("rx", 300)
// 			 .attr("ry", 300)			 	

// 			 .transition()
// 			 .delay(40000)
// 			 .duration(4000)
// 			 .ease([.1,1])			 
// 			 .attr("cy",height)
// 			 	.attr("opacity", ".05")
// 			 .attr("stroke-width","0")
// 			 .attr("stroke","white")
// 			 .attr("rx", function(d,i){
// 				if (d.engaged==="into it"){
// 				return height*2/3;
// 				}
// 				if (d.engaged==="soso"){
// 				return height/3;
// 				} 
// 				if (d.engaged==="out of it"){
// 				return height/4;
// 				} 			 	
// 			 })
// 			 .attr("ry", function(d,i){
// 				if (d.engaged==="into it"){
// 					return height*2/3;
// 				// return height*2/3;
// 				}
// 				if (d.engaged==="soso"){
// 					return height/3;
// 				// return height/2;
// 				} 
// 				if (d.engaged==="out of it"){
// 					return height/4;
// 				// return height/3;
// 				} 			 	
// 			 })

// 			 .transition()
// 			 .delay(70000) //not 81000
// 			 .duration(3000)
// 			 .ease([.1,1])
// 			 // .attr("opacity", ".1")
// 			 .attr("rx", function(d,i){
// 				if (d.engaged==="into it"){
// 				return width/maxResponse*3;
// 				}
// 				if (d.engaged==="soso"){
// 				return width/maxResponse*2;
// 				} 
// 				if (d.engaged==="out of it"){
// 				return height/4;
// 				} 			 	
// 			 })
// 			 .attr("cy", function(d,i) {
// 				if (d.engaged==="into it"){
// 					return height/3;
// 				// return height;
// 				}
// 				if (d.engaged==="soso"){
// 				return height*3/4;
// 				//return height/2;
// 				} 
// 				if (d.engaged==="out of it"){
// 					return height;
// 				// return height/3;
// 				} 
// 			 })

// 			 .transition()
// 			 .delay(90000) //not 14
// 			 .duration(3000)
// 			 .ease([.1,1])
// 			 // .attr("opacity", ".03")
// 			 .attr("rx", function(d,i){
// 				if (d.engaged==="into it"){
// 					return height*2/3;
// 				// return width/maxResponse;
// 				}
// 				if (d.engaged==="soso"){
// 					return height/8;
// 				} 
// 				if (d.engaged==="out of it"){
// 					return height/16;
// 				// return width/maxResponse;
// 				} 			 	
// 			 })
// 			 .attr("ry", function(d,i){
// 				if (d.engaged==="into it"){
// 					return height*2/3;
// 				// return height*2/3;
// 				}
// 				if (d.engaged==="soso"){
// 					return height/8;
// 				// return height/2;
// 				} 
// 				if (d.engaged==="out of it"){
// 					return height/16;
// 				// return height/3;
// 				} 			 	
// 			 })
// 			 .attr("cy", height/2)

// 			 .transition()
// 			 .delay(1500) //not 14
// 			 .duration(3000)
// 			 .ease([.1,1])
// 			 // .attr("opacity", ".03")
// 			 .attr("rx", height/8)
// 			 .attr("ry", height)
// 			 .attr("cx", function(d,i){
// 			 	return bigWidthMap(i)
// 			 })
// 			 .attr("cy", height/2)
// }, 3000);
//THIS WORKS WELL
























});

</script>
</body>
</html>




